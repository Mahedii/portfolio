import{s as x}from"./SubCategoryMethods-z13At4eA.js";import{c as f}from"./Toastr-bncgRa57.js";import{_ as g,f as D,o as p,c as h,b as e,w as _,g as r,d as n,v as i,F as v,r as E,a as M,t as c,e as b}from"./index-Rclj0A4P.js";const U={data(){return{formData:{category_id:null,selectedExpense:null,selectedExpenseParent:null,expenseAmount:0,expenseDate:null,quantity:null,remarks:null,selectedUnit:null,selectedPaymentMethod:null},fetchedFormData:{category_id:null,selectedExpense:null,selectedExpenseParent:null,expenseAmount:0,expenseDate:null,quantity:null,remarks:null,selectedUnit:null,selectedPaymentMethod:null},unitsList:[],unitsListOptions:[],expensesCategories:[],expensesCategoriesOptions:[],expensesList:[],expenseListOptions:[],paymentMethodsList:null,paymentMethodOptions:[]}},created(){this.initialFormData={...this.formData},this.fetchExpenses(),this.fetchMeasurementUnits(),this.fetchExpenseSubCategories(),this.fetchPaymentMethods()},methods:{...x,fetchPaymentMethods(){try{let o={type:"read"};this.axios.post("/payment-methods/data",o).then(t=>{this.paymentMethodsList=t.data.paymentMethods,this.paymentMethodOptions=this.paymentMethodsList.map(a=>({label:a.method,value:a.id.toString()}))})}catch(o){console.error("Error fetching payment methods:",o)}},fetchMeasurementUnits(){try{let o={type:"read"};this.axios.post("/measurement-units/data",o).then(t=>{this.unitsList=t.data.measurementUnits,this.unitsListOptions=this.unitsList.map(a=>({label:a.unit_name,value:a.id.toString()}))})}catch(o){console.error("Error fetching measurement units:",o)}},fetchExpenseSubCategories(){try{let o={type:"read"};this.axios.post("/sub-category/data",o).then(t=>{this.expensesCategories=t.data.subcategories,this.expensesCategoriesOptions=this.expensesCategories.map(a=>({label:a.category_name,value:a.id.toString(),parents:a.parent_category_names}))})}catch(o){console.error("Error fetching sub-categories:",o)}},async fetchExpenses(){try{let o={type:"read"};const t=await this.axios.post("/expenses/data",o);this.expensesList=t.data.expenses,this.expenseListOptions=this.expensesList.map(a=>({label:a.category_name,value:a.id.toString(),parents:a.parent_category_names}))}catch(o){console.error("Error fetching sub-categories:",o)}},async addExpense(){try{this.isSubmitting=!0,this.formData.selectedUnit!=null&&(this.formData.selectedUnit=this.formData.selectedUnit.value);let o={category_id:this.formData.selectedExpense.value,expense_amount:this.formData.expenseAmount,expense_date:this.formData.expenseDate,unit_id:this.formData.selectedUnit,quantity:this.formData.quantity,payment_method_id:this.formData.selectedPaymentMethod.value,remarks:this.formData.remarks,type:"create"};console.log(o),this.axios.post("/expenses/create",o).then(t=>{t.data.status==200?(f.toastrMessage(t.data.message,"success"),this.resetForm(),this.fetchExpenses()):f.toastrMessage(t.data.message,"error")}).catch(t=>(this.isSubmitting=!1,console.log(t),t))}catch(o){return this.isSubmitting=!1,console.log(o),o}},resetForm(o=null){o=="update"?this.fetchedFormData:this.formData,this.formData={...this.initialFormData}},async openEditModal(o){this.fetchedFormData.selectedExpense=o.category_id,this.fetchedFormData.expenseAmount=o.unit_name,this.fetchedFormData.quantity=o.category_id,this.fetchedFormData.selectedUnit=o.unit_name,this.fetchedFormData.expenseDate=o.category_id,this.fetchedFormData.selectedPaymentMethod=o.unit_name,this.fetchedFormData.remarks=o.category_id,this.fetchedFormData.expenseAmount=o.unit_name,jQuery("#editModal").modal("show")},async getSelectedExpenseParent(o){this.formData.category_id=o.value,console.log(this.expensesCategories),console.log(JSON.parse(JSON.stringify(this.expensesCategories)));var t=JSON.parse(JSON.stringify(this.expensesCategories)).filter(a=>{if(a.id==this.formData.category_id)return a});this.formData.selectedExpenseParent=t[0].parent_category_names}}},F={class:"page-content"},V={class:"container-fluid"},C=M('<div class="row"><div class="col-12"><div class="page-title-box d-sm-flex align-items-center justify-content-between"><h4 class="mb-sm-0">Expense</h4><div class="page-title-right"><ol class="breadcrumb m-0"><li class="breadcrumb-item"><a href="javascript: void(0);">Expense</a></li><li class="breadcrumb-item active">Create</li></ol></div></div></div></div>',1),w={class:"row"},S={class:"col-xxl-12"},P={class:"card"},k=e("div",{class:"card-header align-items-center d-flex"},[e("h4",{class:"card-title mb-0 flex-grow-1"},"Expense")],-1),L={class:"card-body"},O={class:"live-preview"},A={class:"col-md-6"},q=e("label",{for:"",class:"form-label"},"Select Source of Expense",-1),N={class:"col-md-6"},R=e("label",{for:"",class:"form-label"},"Expense Parent",-1),J={class:"col-md-4"},j=e("label",{for:"",class:"form-label"},"Expense Amount",-1),B={class:"col-md-4"},Q=e("label",{for:"",class:"form-label"},"Quantity",-1),T={class:"col-md-4"},z=e("label",{for:"",class:"form-label"},"Unit",-1),G={class:"col-md-6"},H=e("label",{for:"",class:"form-label"},"Expense Date",-1),I={class:"col-md-6"},K=e("label",{for:"",class:"form-label"},"Select Payment Method",-1),W={class:"col-md-12"},X=e("label",{for:"",class:"form-label"},"Remarks",-1),Y=e("div",{class:"col-12"},[e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-primary"},"Add")])],-1),Z={class:"modal fade",id:"editModal",tabindex:"-1","aria-labelledby":"editModalLabel","aria-hidden":"true"},$={class:"modal-dialog"},ee={class:"modal-content"},te=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"varyingcontentModalLabel"},"Update form"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),se={class:"modal-body"},oe={class:"row g-3"},le={class:"col-md-6 mb-3"},ae=e("label",{for:"",class:"form-label"},"Select Source of Expense",-1),ne={class:"col-md-6 mb-3"},ie=e("label",{for:"",class:"form-label"},"Expense Parent",-1),de={class:"col-md-4 mb-3"},re=e("label",{for:"",class:"form-label"},"Expense Amount",-1),ce={class:"col-md-4 mb-3"},me=e("label",{for:"",class:"form-label"},"Quantity",-1),pe={class:"col-md-4 mb-3"},he=e("label",{for:"",class:"form-label"},"Unit",-1),ue={class:"col-md-6 mb-3"},fe=e("label",{for:"",class:"form-label"},"Expense Date",-1),_e={class:"col-md-6 mb-3"},be=e("label",{for:"",class:"form-label"},"Select Payment Method",-1),ye={class:"col-md-12 mb-3"},xe=e("label",{for:"",class:"form-label"},"Remarks",-1),ge=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-light","data-bs-dismiss":"modal"},"Close"),e("button",{type:"submit",class:"btn btn-primary"},"Save Changes")],-1),De={class:"row"},ve={class:"col-lg-12"},Ee={class:"card"},Me=e("div",{class:"card-header"},[e("h5",{class:"card-title mb-0"},"Expense List")],-1),Ue={class:"card-body"},Fe={id:"example",class:"table table-bordered dt-responsive nowrap table-striped align-middle",style:{width:"100%"}},Ve=e("thead",null,[e("tr",null,[e("th",null,"No"),e("th",null,"Category"),e("th",null,"Amount"),e("th",null,"Expense Date"),e("th",null,"Payment Method"),e("th",null,"Remarks"),e("th",null,"Action")])],-1),Ce={class:"dropdown d-inline-block"},we=e("button",{class:"btn btn-soft-secondary btn-sm dropdown",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"ri-more-fill align-middle"})],-1),Se={class:"dropdown-menu dropdown-menu-end"},Pe=["onClick"],ke=e("i",{class:"ri-pencil-fill align-bottom me-2 text-muted"},null,-1),Le=["onClick"],Oe=e("i",{class:"ri-delete-bin-fill align-bottom me-2 text-muted"},null,-1);function Ae(o,t,a,qe,l,m){const d=D("v-select");return p(),h("div",F,[e("div",V,[C,e("div",w,[e("div",S,[e("div",P,[k,e("div",L,[e("div",O,[e("form",{onSubmit:t[9]||(t[9]=_((...s)=>m.addExpense&&m.addExpense(...s),["prevent"])),class:"row g-3"},[e("div",A,[q,r(d,{modelValue:l.formData.selectedExpense,"onUpdate:modelValue":t[0]||(t[0]=s=>l.formData.selectedExpense=s),"onOption:selected":t[1]||(t[1]=s=>m.getSelectedExpenseParent(s)),class:"new-styles",placeholder:"Choose one",options:l.expensesCategoriesOptions},null,8,["modelValue","options"])]),e("div",N,[R,n(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.formData.selectedExpenseParent=s),type:"text",class:"form-control",disabled:""},null,512),[[i,l.formData.selectedExpenseParent]])]),e("div",J,[j,n(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.formData.expenseAmount=s),type:"text",class:"form-control",placeholder:"Enter expense name"},null,512),[[i,l.formData.expenseAmount]])]),e("div",B,[Q,n(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.formData.quantity=s),type:"text",class:"form-control",placeholder:"Enter quantity"},null,512),[[i,l.formData.quantity]])]),e("div",T,[z,r(d,{modelValue:l.formData.selectedUnit,"onUpdate:modelValue":t[5]||(t[5]=s=>l.formData.selectedUnit=s),class:"new-styles",placeholder:"Choose one",options:l.unitsListOptions},null,8,["modelValue","options"])]),e("div",G,[H,n(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.formData.expenseDate=s),type:"date",class:"form-control",placeholder:"Enter expense date"},null,512),[[i,l.formData.expenseDate]])]),e("div",I,[K,r(d,{modelValue:l.formData.selectedPaymentMethod,"onUpdate:modelValue":t[7]||(t[7]=s=>l.formData.selectedPaymentMethod=s),class:"new-styles",placeholder:"Choose one",options:l.paymentMethodOptions},null,8,["modelValue","options"])]),e("div",W,[X,n(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=s=>l.formData.remarks=s),class:"form-control",placeholder:"Remarks if any.."},null,512),[[i,l.formData.remarks]])]),Y],32)])])])])]),e("div",Z,[e("div",$,[e("div",ee,[e("form",{onSubmit:t[19]||(t[19]=_((...s)=>o.updateExpense&&o.updateExpense(...s),["prevent"]))},[te,e("div",se,[e("div",oe,[e("div",le,[ae,r(d,{modelValue:l.fetchedFormData.selectedExpense,"onUpdate:modelValue":t[10]||(t[10]=s=>l.fetchedFormData.selectedExpense=s),"onOption:selected":t[11]||(t[11]=s=>m.getSelectedExpenseParent(s)),class:"new-styles",placeholder:"Choose one",options:l.expensesCategoriesOptions},null,8,["modelValue","options"])]),e("div",ne,[ie,n(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>l.fetchedFormData.selectedExpenseParent=s),type:"text",class:"form-control",disabled:""},null,512),[[i,l.fetchedFormData.selectedExpenseParent]])]),e("div",de,[re,n(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>l.fetchedFormData.expenseAmount=s),type:"text",class:"form-control",placeholder:"Enter expense name"},null,512),[[i,l.fetchedFormData.expenseAmount]])]),e("div",ce,[me,n(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>l.fetchedFormData.quantity=s),type:"text",class:"form-control",placeholder:"Enter quantity"},null,512),[[i,l.fetchedFormData.quantity]])]),e("div",pe,[he,r(d,{modelValue:l.fetchedFormData.selectedUnit,"onUpdate:modelValue":t[15]||(t[15]=s=>l.fetchedFormData.selectedUnit=s),class:"new-styles",placeholder:"Choose one",options:l.unitsListOptions},null,8,["modelValue","options"])]),e("div",ue,[fe,n(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>l.fetchedFormData.expenseDate=s),type:"date",class:"form-control",placeholder:"Enter expense date"},null,512),[[i,l.fetchedFormData.expenseDate]])]),e("div",_e,[be,r(d,{modelValue:l.fetchedFormData.selectedPaymentMethod,"onUpdate:modelValue":t[17]||(t[17]=s=>l.fetchedFormData.selectedPaymentMethod=s),class:"new-styles",placeholder:"Choose one",options:l.paymentMethodOptions},null,8,["modelValue","options"])]),e("div",ye,[xe,n(e("textarea",{"onUpdate:modelValue":t[18]||(t[18]=s=>l.fetchedFormData.remarks=s),class:"form-control",placeholder:"Remarks if any.."},null,512),[[i,l.fetchedFormData.remarks]])])])]),ge],32)])])]),e("div",De,[e("div",ve,[e("div",Ee,[Me,e("div",Ue,[e("table",Fe,[Ve,e("tbody",null,[(p(!0),h(v,null,E(this.expensesList,(s,u)=>(p(),h("tr",{key:u},[e("td",null,c(++u),1),e("td",null,c(s.parent_category_names),1),e("td",null,c(s.amount),1),e("td",null,c(o.formatRelativeDate(s.expense_date)),1),e("td",null,c(s.payment_method.method),1),e("td",null,c(s.remarks),1),e("td",null,[e("div",Ce,[we,e("ul",Se,[e("li",null,[e("a",{href:"#",class:"dropdown-item edit-item-btn",onClick:y=>m.openEditModal(s)},[ke,b(" Edit ")],8,Pe)]),e("li",null,[e("a",{href:"#",class:"dropdown-item delete-item-btn",onClick:y=>o.openDeleteModal(s)},[Oe,b(" Delete ")],8,Le)])])])])]))),128))])])])])])])])])}const je=g(U,[["render",Ae]]);export{je as default};
